# Story 04.03: Componentes Financeiros Brasileiros

## Status
**Current Status:** Approved  
**Epic:** 04 - Frontend Implementation  
**Priority:** High  
**Estimated Effort:** 6 days  
**Dependencies:** Design system, Supabase data, tRPC procedures

---

## Story

**As a** usuário brasileiro do AegisWallet,  
**I want** componentes de interface que entendam e exibam corretamente informações financeiras no padrão brasileiro,  
**so that** eu me sinta familiarizado com formatos de moeda, datas e documentos que uso no dia a dia.

---

## Acceptance Criteria

1. [ ] Componentes para exibição de valores em Real (R$ 1.234,56)
2. [ ] Formatação de datas brasileiras (DD/MM/AAAA) e períodos
3. [ ] Componentes específicos para PIX (chaves, QR codes, comprovantes)
4. [ ] Interface para boletos (código de barras, linha digitável, vencimento)
5. [ ] Componentes para CPF/CNPJ com validação e formatação
6. [ ] Suporte a temas claro/escuro com cores brasileiras
7. [ ] Responsividade completa para mobile-first
8. [ ] Acessibilidade WCAG 2.1 AA+ com leitores de tela

---

## Tasks / Subtasks

- [ ] **Componentes de Formatação Monetária** (AC: 1)
  - [ ] Criar componente CurrencyDisplay com formatação BRL
  - [ ] Implementar CurrencyInput com máscara automática
  - [ ] Adicionar suporte a valores negativos (débitos)
  - [ ] Configurar cores semânticas (verde/vermelho)
  - [ ] Implementar animações para mudanças de valor

- [ ] **Componentes de Data Brasileira** (AC: 2)
  - [ ] Criar DateDisplay com formato DD/MM/AAAA
  - [ ] Implementar DatePicker com calendário brasileiro
  - [ ] Adicionar componente de período (mensal, semanal)
  - [ ] Configurar feriados brasileiros
  - [ ] Implementar formatação relativa ("há 2 dias")

- [ ] **Componentes PIX Específicos** (AC: 3)
  - [ ] Criar PixKeyDisplay com formatação por tipo
  - [ ] Implementar PixQRCode generator e scanner
  - [ ] Adicionar PixReceipt para comprovantes
  - [ ] Configurar PixKeyInput com validação
  - [ ] Implementar PixTransferSummary

- [ ] **Componentes de Boletos** (AC: 4)
  - [ ] Criar BoletoDisplay com dados formatados
  - [ ] Implementar BarcodeDisplay para códigos
  - [ ] Adicionar BoletoScanner para captura
  - [ ] Configurar DueDateAlert para vencimentos
  - [ ] Implementar BoletoReceipt para comprovantes

- [ ] **Validação de Documentos** (AC: 5)
  - [ ] Criar CPFInput com validação e formatação
  - [ ] Implementar CNPJInput para empresas
  - [ ] Adicionar DocumentValidator utilitário
  - [ ] Configurar máscaras automáticas
  - [ ] Implementar feedback visual de validação

- [ ] **Sistema de Temas e Responsividade** (AC: 6, 7, 8)
  - [ ] Configurar paleta de cores brasileiras
  - [ ] Implementar tema claro/escuro
  - [ ] Adicionar breakpoints mobile-first
  - [ ] Configurar tipografia responsiva
  - [ ] Implementar acessibilidade completa

---

## Dev Notes

### Arquitetura Relevante

**Estrutura Atual:**
- `src/components/ui/` - Componentes base do shadcn/ui
- `src/lib/utils.ts` - Utilitários gerais
- `tailwind.config.js` - Configuração de estilos

**Novos Componentes:**
- `src/components/financial/CurrencyDisplay.tsx`
- `src/components/financial/DateDisplay.tsx`
- `src/components/pix/PixKeyDisplay.tsx`
- `src/components/boletos/BoletoDisplay.tsx`
- `src/components/forms/CPFInput.tsx`
- `src/lib/formatters/brazilianFormatters.ts`

**Utilitários de Formatação:**
```typescript
// Formatação monetária brasileira
export function formatCurrency(value: number): string {
  return new Intl.NumberFormat('pt-BR', {
    style: 'currency',
    currency: 'BRL'
  }).format(value);
}

// Formatação de data brasileira
export function formatDate(date: Date): string {
  return new Intl.DateTimeFormat('pt-BR').format(date);
}

// Validação de CPF
export function validateCPF(cpf: string): boolean {
  // Implementação do algoritmo de validação
}
```

### Design System Brasileiro

**Paleta de Cores:**
- Primary: Verde (referência ao Real brasileiro)
- Secondary: Azul (confiança bancária)
- Success: Verde escuro (transações bem-sucedidas)
- Warning: Amarelo (alertas e vencimentos)
- Error: Vermelho (falhas e débitos)

**Tipografia:**
- Fonte principal: Inter (legibilidade em mobile)
- Fonte monetária: JetBrains Mono (valores numéricos)
- Tamanhos responsivos com clamp()

### Testing

**Localização:** `src/test/components/financial/`
**Frameworks:** Vitest + Testing Library + Storybook
**Cenários de Teste:**
- Formatação correta de valores e datas
- Validação de documentos brasileiros
- Responsividade em diferentes dispositivos
- Acessibilidade com screen readers
- Temas claro e escuro

**Testes Visuais:**
- Storybook para todos os componentes
- Chromatic para regression testing
- Testes de contraste de cores
- Validação de breakpoints

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-04 | 1.0.0 | Criação inicial da story | PM Agent "John" |

---

## Dev Agent Record

*Esta seção será preenchida pelo agente de desenvolvimento durante a implementação*

---

## QA Results

*Esta seção será preenchida pelo agente de QA após revisão da implementação*