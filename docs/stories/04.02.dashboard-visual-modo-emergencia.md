# Story 04.02: Dashboard Visual (Modo Emergência)

## Status
**Current Status:** Draft  
**Epic:** 04 - Frontend Implementation  
**Priority:** Medium  
**Estimated Effort:** 4 days  
**Dependencies:** Componentes financeiros básicos, tRPC procedures, Design system

---

## Story

**As a** usuário do AegisWallet,  
**I want** um dashboard visual completo que funcione como alternativa quando a interface de voz não for apropriada,  
**so that** eu possa acessar todas as funcionalidades financeiras através de uma interface tradicional clara e eficiente.

---

## Acceptance Criteria

1. [ ] Implementar layout dashboard conforme screen-designs-and-flows.md
2. [ ] Criar Balance Card com formatação brasileira (R$ 1.234,56)
3. [ ] Implementar Transaction List com filtros e categorização
4. [ ] Adicionar Scheduled Payments section com próximos boletos
5. [ ] Criar Quick Actions grid com ações principais
6. [ ] Implementar gráficos e visualizações financeiras
7. [ ] Integrar com Supabase real-time updates
8. [ ] Garantir responsividade completa mobile-first

---

## Tasks / Subtasks

- [ ] **Layout Principal do Dashboard** (AC: 1, 8)
  - [ ] Implementar grid layout responsivo conforme design specs
  - [ ] Criar estrutura de cards modulares
  - [ ] Configurar breakpoints para mobile, tablet, desktop
  - [ ] Implementar navegação lateral colapsável
  - [ ] Adicionar breadcrumbs e indicadores de localização

- [ ] **Balance Card e Resumo Financeiro** (AC: 2)
  - [ ] Criar componente BalanceCard com saldo atual
  - [ ] Implementar formatação monetária brasileira
  - [ ] Adicionar indicadores de tendência (seta verde/vermelha)
  - [ ] Configurar animações suaves para mudanças de valor
  - [ ] Implementar múltiplas contas com seleção

- [ ] **Lista de Transações Avançada** (AC: 3)
  - [ ] Implementar TransactionList com paginação
  - [ ] Adicionar filtros por data, categoria, valor
  - [ ] Configurar busca por descrição
  - [ ] Implementar categorização visual com cores
  - [ ] Adicionar exportação para CSV/PDF

- [ ] **Seção de Pagamentos Agendados** (AC: 4)
  - [ ] Criar ScheduledPayments component
  - [ ] Implementar timeline de próximos boletos
  - [ ] Adicionar alertas para vencimentos próximos
  - [ ] Configurar ações rápidas (pagar agora, adiar)
  - [ ] Implementar status visual (pendente, processando, pago)

- [ ] **Grid de Ações Rápidas** (AC: 5)
  - [ ] Implementar QuickActions com botões principais
  - [ ] Adicionar ações: PIX, Boleto, Transferência, Extrato
  - [ ] Configurar atalhos de teclado para power users
  - [ ] Implementar personalização de ações favoritas
  - [ ] Adicionar tooltips explicativos

- [ ] **Gráficos e Visualizações** (AC: 6)
  - [ ] Implementar gráfico de gastos por categoria (donut chart)
  - [ ] Adicionar gráfico de evolução de saldo (line chart)
  - [ ] Criar visualização de orçamento vs. gastos (bar chart)
  - [ ] Implementar mini-gráficos (sparklines) nos cards
  - [ ] Configurar interatividade e drill-down

- [ ] **Integração Real-time** (AC: 7)
  - [ ] Configurar Supabase subscriptions para saldo
  - [ ] Implementar updates em tempo real para transações
  - [ ] Adicionar notificações toast para mudanças
  - [ ] Configurar sincronização de estado global
  - [ ] Implementar indicadores de conectividade

---

## Dev Notes

### Arquitetura Relevante

**Estrutura Atual:**
- `src/components/ui/` - Componentes base shadcn/ui
- `src/hooks/` - Hooks React existentes
- `src/server/procedures/` - APIs tRPC

**Novos Componentes:**
- `src/components/dashboard/DashboardLayout.tsx` - Layout principal
- `src/components/dashboard/BalanceCard.tsx` - Card de saldo
- `src/components/dashboard/TransactionList.tsx` - Lista de transações
- `src/components/dashboard/ScheduledPayments.tsx` - Pagamentos agendados
- `src/components/dashboard/QuickActions.tsx` - Ações rápidas
- `src/components/charts/FinancialCharts.tsx` - Gráficos financeiros

**Hooks Necessários:**
- `src/hooks/useDashboardData.ts` - Dados do dashboard
- `src/hooks/useRealTimeUpdates.ts` - Updates em tempo real
- `src/hooks/useFinancialCharts.ts` - Dados para gráficos

**Schema de Dados:**
```typescript
interface DashboardData {
  balance: {
    current: number;
    available: number;
    trend: 'up' | 'down' | 'stable';
    change: number;
  };
  transactions: Transaction[];
  scheduledPayments: ScheduledPayment[];
  categories: CategorySummary[];
  monthlyTrend: MonthlyData[];
}

interface Transaction {
  id: string;
  description: string;
  amount: number;
  category: string;
  date: string;
  type: 'income' | 'expense';
  status: 'completed' | 'pending' | 'failed';
}
```

### Design System

**Layout Grid:**
- Desktop: 12 colunas com gaps de 24px
- Tablet: 8 colunas com gaps de 16px
- Mobile: 4 colunas com gaps de 12px

**Componentes de Card:**
- Border radius: 12px
- Shadow: soft drop shadow
- Padding: 24px desktop, 16px mobile
- Background: white/dark mode compatible

**Cores Financeiras:**
- Verde: Receitas e saldos positivos
- Vermelho: Despesas e saldos negativos
- Azul: Transferências e PIX
- Laranja: Boletos e contas a pagar
- Cinza: Transações neutras

### Gráficos e Visualizações

**Biblioteca:** Recharts (compatível com React 19)
**Tipos de Gráfico:**
- Donut Chart: Gastos por categoria
- Line Chart: Evolução do saldo
- Bar Chart: Orçamento vs. gastos
- Area Chart: Fluxo de caixa
- Sparklines: Tendências rápidas

**Configurações:**
- Responsivos por padrão
- Cores do design system
- Animações suaves
- Tooltips informativos
- Acessibilidade completa

### Real-time Updates

**Supabase Subscriptions:**
```typescript
// Subscription para saldo
const { data: balance } = useSubscription(
  supabase
    .from('account_balances')
    .on('UPDATE', payload => {
      // Update balance in real-time
    })
    .subscribe()
);

// Subscription para transações
const { data: transactions } = useSubscription(
  supabase
    .from('transactions')
    .on('INSERT', payload => {
      // Add new transaction
    })
    .subscribe()
);
```

### Testing

**Localização:** `src/test/components/dashboard/`
**Frameworks:** Vitest + Testing Library + Storybook
**Cenários de Teste:**
- Renderização correta em diferentes dispositivos
- Funcionamento de filtros e busca
- Updates em tempo real
- Interatividade dos gráficos
- Performance com grandes datasets

**Testes Visuais:**
- Storybook para todos os componentes
- Chromatic para regression testing
- Responsividade em diferentes breakpoints
- Temas claro e escuro

**Métricas de Performance:**
- Tempo de carregamento inicial <3s
- Smooth scrolling em listas grandes
- Animações a 60fps
- Memory usage otimizado

### Acessibilidade

**WCAG 2.1 AA+ Requirements:**
- Navegação completa por teclado
- Screen reader compatibility
- Contraste adequado (4.5:1 mínimo)
- Focus indicators visíveis
- Textos alternativos para gráficos

**Funcionalidades Específicas:**
- Atalhos de teclado para ações rápidas
- Anúncios de mudanças para screen readers
- High contrast mode
- Reduced motion support
- Zoom até 200% sem perda de funcionalidade

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-04 | 1.0.0 | Criação inicial da story | PM Agent "John" |

---

## Dev Agent Record

*Esta seção será preenchida pelo agente de desenvolvimento durante a implementação*

### Agent Model Used
*TBD*

### Debug Log References
*TBD*

### Completion Notes List
*TBD*

### File List
*TBD*

---

## QA Results

*Esta seção será preenchida pelo agente de QA após revisão da implementação*